<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°ç™½å¤©åœ° - ç®¡ç†åå°</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/3.3.0/tailwind.min.css">
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    .admin-sidebar {
      width: 250px;
      background-color: #2c3e50;
      color: white;
      height: 100vh;
      position: fixed;
      overflow-y: auto;
    }
    .admin-main {
      margin-left: 250px;
      padding: 20px;
    }
    .nav-link {
      display: block;
      color: #bdc3c7;
      padding: 12px 20px;
      text-decoration: none;
      transition: all 0.3s;
    }
    .nav-link:hover, .nav-link.active {
      background: #34495e;
      color: #3498db;
    }
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
    }
    .dashboard-card {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      text-decoration: none;
      color: inherit;
      transition: transform 0.3s;
    }
    .dashboard-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;
    
    // å¯¼èˆªç»„ä»¶
    const Sidebar = ({ activePage, setActivePage }) => {
      const menuItems = [
        { id: 'dashboard', label: 'ä»ªè¡¨æ¿', icon: 'ğŸ“Š' },
        { id: 'content', label: 'å†…å®¹ç®¡ç†', icon: 'ğŸ“' },
        { id: 'analytics', label: 'è®¿é—®ç»Ÿè®¡', icon: 'ğŸ“ˆ' },
        { id: 'seo', label: 'SEOä¼˜åŒ–', icon: 'ğŸ”' },
        { id: 'ads', label: 'å¹¿å‘Šç®¡ç†', icon: 'ğŸ“¢' },
        { id: 'settings', label: 'ç½‘ç«™è®¾ç½®', icon: 'âš™ï¸' },
        { id: 'python', label: 'PythonåŠŸèƒ½', icon: 'ğŸ' },
      ];
      
      return (
        <div className="admin-sidebar">
          <div className="p-5 border-b border-gray-700">
            <h2 className="text-xl font-bold">ç®¡ç†åå°</h2>
          </div>
          <nav>
            {menuItems.map(item => (
              <a 
                key={item.id}
                href="#" 
                className={`nav-link ${activePage === item.id ? 'active' : ''}`}
                onClick={(e) => {
                  e.preventDefault();
                  setActivePage(item.id);
                }}
              >
                <span className="mr-2">{item.icon}</span>
                {item.label}
              </a>
            ))}
          </nav>
        </div>
      );
    };
    
    // ä»ªè¡¨æ¿ç»„ä»¶
    const Dashboard = () => {
      const [stats, setStats] = useState({
        totalVisits: 0,
        todayVisits: 0,
        onlineUsers: 0,
        postCount: 0
      });
      
      useEffect(() => {
        // æ¨¡æ‹Ÿè·å–ç»Ÿè®¡æ•°æ®
        fetch('/api/analytics/stats')
          .then(res => res.json())
          .then(data => setStats({
            totalVisits: data.totalVisits || 0,
            todayVisits: data.todayVisits || 0,
            onlineUsers: data.onlineUsers || 0,
            postCount: data.postCount || 0
          }))
          .catch(() => {
            // æ¨¡æ‹Ÿæ•°æ®
            setStats({
              totalVisits: 5421,
              todayVisits: 42,
              onlineUsers: 8,
              postCount: 24
            });
          });
      }, []);
      
      return (
        <div>
          <h1 className="text-2xl font-bold mb-6">ä»ªè¡¨æ¿</h1>
          <div className="dashboard-grid mb-8">
            <div className="dashboard-card">
              <h3 className="text-lg font-semibold mb-2">æ€»è®¿é—®é‡</h3>
              <p className="text-3xl font-bold text-blue-600">{stats.totalVisits}</p>
            </div>
            <div className="dashboard-card">
              <h3 className="text-lg font-semibold mb-2">ä»Šæ—¥è®¿é—®</h3>
              <p className="text-3xl font-bold text-green-600">{stats.todayVisits}</p>
            </div>
            <div className="dashboard-card">
              <h3 className="text-lg font-semibold mb-2">åœ¨çº¿ç”¨æˆ·</h3>
              <p className="text-3xl font-bold text-yellow-600">{stats.onlineUsers}</p>
            </div>
            <div className="dashboard-card">
              <h3 className="text-lg font-semibold mb-2">æ–‡ç« æ•°</h3>
              <p className="text-3xl font-bold text-purple-600">{stats.postCount}</p>
            </div>
          </div>
          
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div className="bg-white p-6 rounded-lg shadow">
              <h3 className="text-lg font-semibold mb-4">æœ€è¿‘æ–‡ç« </h3>
              <ul className="space-y-2">
                <li className="flex justify-between border-b pb-2">
                  <span>Astroé™æ€ç«™ç‚¹ç”Ÿæˆå™¨å…¥é—¨æŒ‡å—</span>
                  <span className="text-gray-500">2025-01-15</span>
                </li>
                <li className="flex justify-between border-b pb-2">
                  <span>TypeScriptåœ¨ç°ä»£Webå¼€å‘ä¸­çš„åº”ç”¨</span>
                  <span className="text-gray-500">2025-01-14</span>
                </li>
                <li className="flex justify-between">
                  <span>Tailwind CSSå“åº”å¼è®¾è®¡å®è·µ</span>
                  <span className="text-gray-500">2025-01-13</span>
                </li>
              </ul>
            </div>
            <div className="bg-white p-6 rounded-lg shadow">
              <h3 className="text-lg font-semibold mb-4">å¿«é€Ÿæ“ä½œ</h3>
              <div className="space-y-3">
                <button className="w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">
                  æ–°å»ºæ–‡ç« 
                </button>
                <button className="w-full bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600">
                  ç®¡ç†è¯„è®º
                </button>
                <button className="w-full bg-purple-500 text-white py-2 px-4 rounded hover:bg-purple-600">
                  æŸ¥çœ‹SEOæŠ¥å‘Š
                </button>
              </div>
            </div>
          </div>
        </div>
      );
    };
    
    // ä¸“é—¨çš„æ–‡ç« ç¼–è¾‘å™¨ç»„ä»¶
    const ArticleEditor = () => {
      const [article, setArticle] = useState({
        title: '',
        description: '',
        content: '',
        status: 'draft',
        categories: '',
        tags: '',
        featuredImg: '',
        type: 'blog'
      });
      const [isPreview, setIsPreview] = useState(false);
      const [imageList, setImageList] = useState([]);
      const [showImageManager, setShowImageManager] = useState(false);
      const [dragActive, setDragActive] = useState(false);
      const contentRef = useRef(null);

      // è·å–å›¾ç‰‡åˆ—è¡¨
      useEffect(() => {
        fetch('/api/images')
          .then(res => res.json())
          .then(data => setImageList(data))
          .catch(() => setImageList([]));
      }, []);

      // å¤„ç†å›¾ç‰‡ä¸Šä¼ 
      const handleImageUpload = async (files) => {
        for (const file of files) {
          if (!file.type.startsWith('image/')) continue;

          const formData = new FormData();
          formData.append('image', file);

          try {
            const response = await fetch('/api/upload', {
              method: 'POST',
              body: formData
            });

            const result = await response.json();

            if (result.success) {
              // æ›´æ–°å›¾ç‰‡åˆ—è¡¨
              fetch('/api/images')
                .then(res => res.json())
                .then(data => setImageList(data));

              // åœ¨ç¼–è¾‘å™¨ä¸­æ’å…¥å›¾ç‰‡å¼•ç”¨
              const imgMarkdown = `![${file.name}](${result.path})\n`;
              setArticle(prev => ({...prev, content: prev.content + imgMarkdown}));
            } else {
              alert('ä¸Šä¼ å¤±è´¥: ' + result.error);
            }
          } catch (error) {
            console.error('ä¸Šä¼ å›¾ç‰‡æ—¶å‡ºé”™:', error);
            alert('ä¸Šä¼ å¤±è´¥: ' + error.message);
          }
        }
      };

      // å¤„ç†æ–‡ä»¶æ‹–æ‹½äº‹ä»¶
      const handleDrag = (e) => {
        e.preventDefault();
        e.stopPropagation();
        if (e.type === "dragenter" || e.type === "dragover") {
          setDragActive(true);
        } else if (e.type === "dragleave") {
          setDragActive(false);
        }
      };

      // å¤„ç†æ–‡ä»¶æ‹–æ”¾äº‹ä»¶
      const handleDrop = (e) => {
        e.preventDefault();
        e.stopPropagation();
        setDragActive(false);

        if (e.dataTransfer.files && e.dataTransfer.files[0]) {
          handleImageUpload(e.dataTransfer.files);
        }
      };

      // å¤„ç†ç²˜è´´äº‹ä»¶
      const handlePaste = (e) => {
        const items = (e.clipboardData || e.originalEvent.clipboardData).items;
        for (const item of items) {
          if (item.type.indexOf('image') !== -1) {
            const file = item.getAsFile();
            handleImageUpload([file]);
          }
        }
      };

      // å¤„ç†æ–‡ä»¶è¾“å…¥
      const handleFileInput = (e) => {
        if (e.target.files && e.target.files[0]) {
          handleImageUpload(e.target.files);
        }
      };

      // æ’å…¥å›¾ç‰‡åˆ°ç¼–è¾‘å™¨
      const insertImage = (imagePath) => {
        const imgMarkdown = `![å›¾ç‰‡](${imagePath})\n`;
        setArticle(prev => ({...prev, content: prev.content + imgMarkdown}));
        setShowImageManager(false);
      };

      // ä¿å­˜æ–‡ç« 
      const saveArticle = async () => {
        if (!article.title || !article.content) {
          alert('è¯·å¡«å†™æ ‡é¢˜å’Œå†…å®¹');
          return;
        }

        // è§£æåˆ†ç±»å’Œæ ‡ç­¾
        const categories = article.categories ? article.categories.split(',').map(c => c.trim()) : [];
        const tags = article.tags ? article.tags.split(',').map(t => t.trim()) : [];

        // æ„å»ºfrontmatteræ•°æ®
        const data = {
          title: article.title,
          description: article.description,
          status: article.status,
          createdAt: new Date().toISOString(),
          categories: categories.length > 0 ? categories : undefined,
          tags: tags.length > 0 ? tags : undefined,
          featuredImg: article.featuredImg || undefined
        };

        try {
          const response = await fetch('/api/content', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              type: article.type,
              slug: article.title.toLowerCase().replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g, '-').replace(/-+/g, '-'),
              data,
              content: article.content
            })
          });

          const result = await response.json();

          if (result.success) {
            alert('æ–‡ç« ä¿å­˜æˆåŠŸï¼');
          } else {
            alert('ä¿å­˜å¤±è´¥: ' + result.error);
          }
        } catch (error) {
          console.error('ä¿å­˜æ–‡ç« æ—¶å‡ºé”™:', error);
          alert('ä¿å­˜å¤±è´¥: ' + error.message);
        }
      };

      // åˆ‡æ¢é¢„è§ˆæ¨¡å¼
      const togglePreview = () => {
        setIsPreview(!isPreview);
      };

      return (
        <div className="bg-white p-6 rounded-lg shadow">
          <h2 className="text-2xl font-bold mb-6">æ–‡ç« ç¼–è¾‘å™¨</h2>

          <div className="grid grid-cols-1 lg:grid-cols-4 gap-6">
            {/* å·¦å´å·¥å…·æ¬„ */}
            <div className="lg:col-span-1">
              <div className="bg-gray-50 p-4 rounded-lg">
                <h3 className="font-semibold mb-4">æ–‡ç« è¨­ç½®</h3>

                <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-1">æ–‡ç« é¡å‹</label>
                  <select
                    className="w-full border border-gray-300 rounded-md p-2"
                    value={article.type}
                    onChange={(e) => setArticle({...article, type: e.target.value})}
                  >
                    <option value="blog">åšå®¢æ–‡ç« </option>
                    <option value="pages">é é¢</option>
                    <option value="notes">ç­†è¨˜</option>
                  </select>
                </div>

                <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-1">ç‹€æ…‹</label>
                  <select
                    className="w-full border border-gray-300 rounded-md p-2"
                    value={article.status}
                    onChange={(e) => setArticle({...article, status: e.target.value})}
                  >
                    <option value="draft">è‰ç¨¿</option>
                    <option value="published">å·²ç™¼å¸ƒ</option>
                    <option value="archived">å·²æ­¸æª”</option>
                  </select>
                </div>

                <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-1">æ¨™é¡Œ</label>
                  <input
                    type="text"
                    className="w-full border border-gray-300 rounded-md p-2"
                    value={article.title}
                    onChange={(e) => setArticle({...article, title: e.target.value})}
                    placeholder="æ–‡ç« æ¨™é¡Œ"
                  />
                </div>

                <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-1">æè¿°</label>
                  <textarea
                    className="w-full border border-gray-300 rounded-md p-2"
                    value={article.description}
                    onChange={(e) => setArticle({...article, description: e.target.value})}
                    placeholder="æ–‡ç« æè¿°"
                    rows="3"
                  />
                </div>

                <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-1">åˆ†é¡</label>
                  <input
                    type="text"
                    className="w-full border border-gray-300 rounded-md p-2"
                    value={article.categories}
                    onChange={(e) => setArticle({...article, categories: e.target.value})}
                    placeholder="åˆ†é¡1, åˆ†é¡2"
                  />
                </div>

                <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-1">æ¨™ç±¤</label>
                  <input
                    type="text"
                    className="w-full border border-gray-300 rounded-md p-2"
                    value={article.tags}
                    onChange={(e) => setArticle({...article, tags: e.target.value})}
                    placeholder="æ¨™ç±¤1, æ¨™ç±¤2"
                  />
                </div>

                <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-1">å°é¢åœ–ç‰‡</label>
                  <input
                    type="file"
                    accept="image/*"
                    className="w-full border border-gray-300 rounded-md p-2"
                    onChange={handleFileInput}
                  />
                  {article.featuredImg && (
                    <div className="mt-2">
                      <p className="text-sm text-gray-600">ç•¶å‰å°é¢: {article.featuredImg}</p>
                    </div>
                  )}
                </div>

                <div className="flex space-x-2">
                  <button
                    className="flex-1 bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600"
                    onClick={saveArticle}
                  >
                    ä¿å­˜
                  </button>
                  <button
                    className="flex-1 bg-gray-500 text-white py-2 px-4 rounded hover:bg-gray-600"
                    onClick={togglePreview}
                  >
                    {isPreview ? 'ç·¨è¼¯' : 'é è¦½'}
                  </button>
                </div>
              </div>

              <div className="mt-4">
                <button
                  className="w-full bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 mb-2"
                  onClick={() => setShowImageManager(true)}
                >
                  æ’å…¥åœ–ç‰‡
                </button>
                <button
                  className="w-full bg-purple-500 text-white py-2 px-4 rounded hover:bg-purple-600"
                  onClick={() => {
                    // æ’å…¥å¸¸ç”¨Markdownæ ¼å¼
                    const newContent = article.content +
                      '\n# æ¨™é¡Œ\n\né€™æ˜¯æ®µè½ã€‚\n\n## å­æ¨™é¡Œ\n\n- åˆ—è¡¨é …ç›®1\n- åˆ—è¡¨é …ç›®2\n\n**åŠ ç²—æ–‡å­—** æˆ– *æ–œé«”æ–‡å­—*\n\n';
                    setArticle({...article, content: newContent});
                  }}
                >
                  æ’å…¥æ ¼å¼
                </button>
              </div>
            </div>

            {/* ä¸»ç·¨è¼¯å€åŸŸ */}
            <div className="lg:col-span-3">
              <div
                className={`w-full border-2 border-dashed rounded-md p-4 h-96 font-mono text-sm ${
                  dragActive ? "border-blue-500 bg-blue-50" : "border-gray-300"
                }`}
                onDragEnter={handleDrag}
                onDragOver={handleDrag}
                onDragLeave={handleDrag}
                onDrop={handleDrop}
                onPaste={handlePaste}
                ref={contentRef}
              >
                {isPreview ? (
                  <div className="h-full overflow-y-auto">
                    <h2 className="text-2xl font-bold mb-4">{article.title || 'æ–‡ç« æ¨™é¡Œ'}</h2>
                    <div className="prose max-w-none">
                      {article.content ? (
                        <div dangerouslySetInnerHTML={{__html: article.content.replace(/\n/g, '<br />')}} />
                      ) : (
                        <p className="text-gray-500">é è¦½å…§å®¹...</p>
                      )}
                    </div>
                  </div>
                ) : (
                  <textarea
                    className="w-full h-full resize-none focus:outline-none"
                    value={article.content}
                    onChange={(e) => setArticle({...article, content: e.target.value})}
                    placeholder="# æ–‡ç« æ¨™é¡Œ

é€™é‡Œæ˜¯æ–‡ç« å…§å®¹ã€‚

## å­æ¨™é¡Œ

æ‚¨å¯ä»¥ä½¿ç”¨Markdownèªæ³•ï¼š

- åˆ—è¡¨é …ç›®1
- åˆ—è¡¨é …ç›®2

**åŠ ç²—æ–‡å­—** æˆ– *æ–œé«”æ–‡å­—*

![åœ–ç‰‡](åœ–ç‰‡è·¯å¾‘)
"
                  />
                )}
                {dragActive && (
                  <div className="absolute inset-0 bg-blue-100 bg-opacity-75 flex items-center justify-center rounded-md">
                    <p className="text-xl text-blue-500 font-bold">é‡‹æ”¾ä»¥ä¸Šå‚³åœ–ç‰‡</p>
                  </div>
                )}
              </div>

              <div className="mt-2 text-sm text-gray-500">
                <p>æç¤º: æ‚¨å¯ä»¥æ‹–æ‹½åœ–ç‰‡åˆ°ç·¨è¼¯å€åŸŸï¼Œæˆ–åœ¨é€™è£¡ç²˜è²¼åœ–ç‰‡</p>
              </div>
            </div>
          </div>

          {/* åœ–ç‰‡ç®¡ç†å™¨æ¨¡æ…‹æ¡† */}
          {showImageManager && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-lg w-full max-w-2xl max-h-96 overflow-hidden flex flex-col">
                <div className="p-4 border-b flex justify-between items-center">
                  <h3 className="text-lg font-semibold">é¸æ“‡åœ–ç‰‡</h3>
                  <button
                    className="text-gray-500 hover:text-gray-700"
                    onClick={() => setShowImageManager(false)}
                  >
                    âœ•
                  </button>
                </div>
                <div className="p-4 overflow-y-auto flex-1">
                  <div className="mb-4">
                    <label className="block text-sm font-medium text-gray-700 mb-1">ä¸Šå‚³æ–°åœ–ç‰‡ (é»æ“Šæˆ–æ‹–æ‹½)</label>
                    <div
                      className={`border-2 border-dashed rounded p-4 text-center cursor-pointer ${
                        dragActive ? "border-blue-500 bg-blue-50" : "border-gray-300"
                      }`}
                      onDragEnter={handleDrag}
                      onDragOver={handleDrag}
                      onDragLeave={handleDrag}
                      onDrop={(e) => {
                        handleDrop(e);
                        // ä¹Ÿå…³é—­æ¨¡æ€æ¡†
                        setTimeout(() => setShowImageManager(false), 500);
                      }}
                      onClick={() => document.getElementById('fileInputManager').click()}
                    >
                      <p className="text-gray-500">é»æ“Šé¸æ“‡åœ–ç‰‡æˆ–æ‹–æ‹½åœ–ç‰‡åˆ°é€™è£¡</p>
                      <input
                        id="fileInputManager"
                        type="file"
                        accept="image/*"
                        className="hidden"
                        onChange={(e) => {
                          handleFileInput(e);
                          // ä¹Ÿå…³é—­æ¨¡æ€æ¡†
                          setTimeout(() => setShowImageManager(false), 500);
                        }}
                      />
                    </div>
                  </div>
                  <div className="grid grid-cols-3 gap-4">
                    {imageList.map((image, index) => (
                      <div
                        key={index}
                        className="border rounded p-2 cursor-pointer hover:bg-gray-100"
                        onClick={() => insertImage(image.url)}
                      >
                        <div className="aspect-square bg-gray-200 rounded flex items-center justify-center mb-1">
                          <span className="text-xs text-gray-500">åœ–ç‰‡</span>
                        </div>
                        <p className="text-xs truncate">{image.name}</p>
                      </div>
                    ))}
                  </div>
                </div>
                <div className="p-4 border-t flex justify-end">
                  <button
                    className="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600"
                    onClick={() => setShowImageManager(false)}
                  >
                    é—œé–‰
                  </button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    };

    // å†…å®¹ç®¡ç†ç»„ä»¶
    const ContentManagement = () => {
      const [activeTab, setActiveTab] = useState('blog');
      const [contentList, setContentList] = useState([]);
      const [showEditor, setShowEditor] = useState(false);

      const tabs = [
        { id: 'blog', label: 'åšå®¢æ–‡ç« ' },
        { id: 'pages', label: 'é¡µé¢' },
        { id: 'notes', label: 'ç¬”è®°' },
        { id: 'categories', label: 'åˆ†ç±»' },
        { id: 'tags', label: 'æ ‡ç­¾' },
      ];

      useEffect(() => {
        fetch(`/api/content-list.json?type=${activeTab}`)
          .then(res => res.json())
          .then(data => setContentList(data))
          .catch(() => {
            setContentList([]);
          });
      }, [activeTab]);

      if (showEditor) {
        return (
          <div>
            <div className="flex justify-between items-center mb-6">
              <h1 className="text-2xl font-bold">æ–‡ç« ç¼–è¾‘å™¨</h1>
              <button 
                className="bg-gray-500 text-white py-2 px-4 rounded hover:bg-gray-600"
                onClick={() => setShowEditor(false)}
              >
                è¿”å›åˆ—è¡¨
              </button>
            </div>
            <ArticleEditor key={`editor-${Date.now()}`} />
          </div>
        );
      }

      return (
        <div>
          <div className="flex justify-between items-center mb-6">
            <h1 className="text-2xl font-bold">å†…å®¹ç®¡ç†</h1>
            <div className="space-x-2">
              <button
                className="bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600"
                onClick={() => setShowEditor(true)}
              >
                æ–°å»ºå›¾æ–‡
              </button>
            </div>
          </div>

          <div className="mb-6 border-b">
            <nav className="flex space-x-6">
              {tabs.map(tab => (
                <button
                  key={tab.id}
                  className={`py-2 px-1 border-b-2 font-medium text-sm ${
                    activeTab === tab.id
                      ? 'border-blue-500 text-blue-600'
                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                  }`}
                  onClick={() => setActiveTab(tab.id)}
                >
                  {tab.label}
                </button>
              ))}
            </nav>
          </div>

          <div className="bg-white shadow overflow-hidden sm:rounded-md">
            <ul className="divide-y divide-gray-200">
              {contentList.map(item => (
                <li key={item.id}>
                  <div className="px-4 py-4 sm:px-6 flex justify-between items-center">
                    <div className="flex items-center">
                      <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                        item.status === 'published'
                          ? 'bg-green-100 text-green-800'
                          : item.status === 'draft'
                            ? 'bg-yellow-100 text-yellow-800'
                            : 'bg-gray-100 text-gray-800'
                      }`}>
                        {item.status === 'published' ? 'å·²å‘å¸ƒ' : item.status === 'draft' ? 'è‰ç¨¿' : 'å½’æ¡£'}
                      </span>
                      <p className="ml-4 text-sm font-medium text-gray-900">{item.title}</p>
                    </div>
                    <div className="flex items-center space-x-4">
                      <p className="text-sm text-gray-500">{new Date(item.createdAt).toLocaleDateString()}</p>
                      <p className="text-sm text-gray-500">æµè§ˆ: {item.views || 0}</p>
                      <button className="text-indigo-600 hover:text-indigo-900 text-sm">ç¼–è¾‘</button>
                    </div>
                  </div>
                </li>
              ))}
            </ul>
          </div>
        </div>
      );
    };
    
    // è®¿é—®ç»Ÿè®¡ç»„ä»¶
    const Analytics = () => {
      const [stats, setStats] = useState({
        totalVisits: 0,
        todayVisits: 0,
        onlineUsers: 0,
        topPosts: [],
        trafficSources: []
      });
      
      useEffect(() => {
        // è·å–ç»Ÿè®¡ä¿¡æ¯
        Promise.all([
          fetch('/api/analytics/stats').then(res => res.json()),
          fetch('/api/analytics/top-posts').then(res => res.json()),
          fetch('/api/analytics/traffic-sources').then(res => res.json())
        ])
        .then(([statsData, topPostsData, trafficData]) => {
          setStats({
            totalVisits: statsData.totalVisits || 0,
            todayVisits: statsData.todayVisits || 0,
            onlineUsers: statsData.onlineUsers || 0,
            topPosts: topPostsData,
            trafficSources: trafficData
          });
        })
        .catch(() => {
          // æ¨¡æ‹Ÿæ•°æ®
          setStats({
            totalVisits: 5421,
            todayVisits: 42,
            onlineUsers: 8,
            topPosts: [
              { title: 'Astroé™æ€ç«™ç‚¹ç”Ÿæˆå™¨å…¥é—¨æŒ‡å—', slug: 'astro-guide', views: 1240 },
              { title: 'TypeScriptåœ¨ç°ä»£Webå¼€å‘ä¸­çš„åº”ç”¨', slug: 'typescript-tips', views: 982 },
              { title: 'Tailwind CSSå“åº”å¼è®¾è®¡å®è·µ', slug: 'tailwind-practice', views: 876 }
            ],
            trafficSources: [
              { name: 'ç›´æ¥è®¿é—®', count: 2340, percentage: 45.2 },
              { name: 'æœç´¢å¼•æ“', count: 1890, percentage: 36.7 },
              { name: 'ç¤¾äº¤åª’ä½“', count: 654, percentage: 12.3 },
              { name: 'å¼•èç½‘ç«™', count: 301, percentage: 5.8 }
            ]
          });
        });
      }, []);
      
      return (
        <div>
          <h1 className="text-2xl font-bold mb-6">è®¿é—®ç»Ÿè®¡</h1>
          
          <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div className="bg-white p-6 rounded-lg shadow">
              <h3 className="text-lg font-semibold mb-2">æ€»è®¿é—®é‡</h3>
              <p className="text-3xl font-bold text-blue-600">{stats.totalVisits}</p>
            </div>
            <div className="bg-white p-6 rounded-lg shadow">
              <h3 className="text-lg font-semibold mb-2">ä»Šæ—¥è®¿é—®</h3>
              <p className="text-3xl font-bold text-green-600">{stats.todayVisits}</p>
            </div>
            <div className="bg-white p-6 rounded-lg shadow">
              <h3 className="text-lg font-semibold mb-2">åœ¨çº¿ç”¨æˆ·</h3>
              <p className="text-3xl font-bold text-yellow-600">{stats.onlineUsers}</p>
            </div>
            <div className="bg-white p-6 rounded-lg shadow">
              <h3 className="text-lg font-semibold mb-2">è·³å‡ºç‡</h3>
              <p className="text-3xl font-bold text-red-600">42%</p>
            </div>
          </div>
          
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div className="bg-white p-6 rounded-lg shadow">
              <h3 className="text-lg font-semibold mb-4">çƒ­é—¨æ–‡ç« </h3>
              <ul className="space-y-3">
                {stats.topPosts.map((post, index) => (
                  <li key={index} className="flex justify-between items-center border-b pb-2">
                    <span>{index + 1}. {post.title}</span>
                    <span className="bg-gray-100 px-2 py-1 rounded">{post.views} æ¬¡æµè§ˆ</span>
                  </li>
                ))}
              </ul>
            </div>
            
            <div className="bg-white p-6 rounded-lg shadow">
              <h3 className="text-lg font-semibold mb-4">æµé‡æ¥æº</h3>
              <ul className="space-y-3">
                {stats.trafficSources.map((source, index) => (
                  <li key={index} className="flex justify-between items-center border-b pb-2">
                    <span>{source.name}</span>
                    <div className="flex items-center">
                      <span className="mr-2 bg-gray-100 px-2 py-1 rounded">{source.count} æ¬¡è®¿é—®</span>
                      <span>({source.percentage}%)</span>
                    </div>
                  </li>
                ))}
              </ul>
            </div>
          </div>
        </div>
      );
    };
    
    // å…¶ä»–ç»„ä»¶å ä½ç¬¦
    const SeoSettings = () => (
      <div>
        <h1 className="text-2xl font-bold mb-6">SEOä¼˜åŒ–è®¾ç½®</h1>
        <p className="text-gray-600">SEO è®¾ç½®é¡µé¢ - ç½‘ç«™æ ‡é¢˜ã€æè¿°ã€å…³é”®è¯ç­‰é…ç½®</p>
        <div className="bg-white p-6 rounded-lg shadow mt-4">
          <h3 className="text-lg font-semibold mb-4">é¡µé¢SEOè®¾ç½®</h3>
          <div className="space-y-4">
            <div>
              <label className="block text-sm font-medium text-gray-700">ç½‘ç«™æ ‡é¢˜</label>
              <input type="text" className="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="ç½‘ç«™çš„ä¸»è¦æ ‡é¢˜" />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700">ç½‘ç«™æè¿°</label>
              <textarea className="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="ç½‘ç«™çš„ç®€çŸ­æè¿°" />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700">å…³é”®è¯</label>
              <input type="text" className="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="ç”¨é€—å·åˆ†éš”çš„å…³é”®è¯" />
            </div>
            <button className="bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">ä¿å­˜è®¾ç½®</button>
          </div>
        </div>
      </div>
    );
    
    const AdManagement = () => (
      <div>
        <h1 className="text-2xl font-bold mb-6">å¹¿å‘Šç®¡ç†</h1>
        <p className="text-gray-600">å¹¿å‘Šç®¡ç†é¡µé¢ - ç®¡ç†ç½‘ç«™å¹¿å‘Šä½å’Œå¹¿å‘Šå†…å®¹</p>
        <div className="bg-white p-6 rounded-lg shadow mt-4">
          <h3 className="text-lg font-semibold mb-4">å¹¿å‘Šåˆ—è¡¨</h3>
          <div className="overflow-x-auto">
            <table className="min-w-full divide-y divide-gray-200">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">å¹¿å‘Šåç§°</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-700">ç±»å‹</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">çŠ¶æ€</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">å±•ç¤ºæ¬¡æ•°</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ“ä½œ</th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-200">
                <tr>
                  <td className="px-6 py-4 whitespace-nowrap">é¦–é¡µæ¨ªå¹…å¹¿å‘Š</td>
                  <td className="px-6 py-4 whitespace-nowrap">æ¨ªå¹…å¹¿å‘Š</td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <span className="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">å¯ç”¨</span>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">12,400</td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    <button className="text-indigo-600 hover:text-indigo-900 mr-2">ç¼–è¾‘</button>
                    <button className="text-red-600 hover:text-red-900">åˆ é™¤</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    );
    
    const SiteSettings = () => (
      <div>
        <h1 className="text-2xl font-bold mb-6">ç½‘ç«™è®¾ç½®</h1>
        <p className="text-gray-600">ç½‘ç«™è®¾ç½®é¡µé¢ - ç®¡ç†ç½‘ç«™å›¾æ ‡ã€å¤‡æ¡ˆä¿¡æ¯ã€è”ç³»æ–¹å¼ç­‰</p>
        <div className="bg-white p-6 rounded-lg shadow mt-4">
          <h3 className="text-lg font-semibold mb-4">åŸºæœ¬ä¿¡æ¯</h3>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium text-gray-700">ç½‘ç«™åç§°</label>
              <input type="text" className="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="ç½‘ç«™çš„åç§°" />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700">ç½‘ç«™URL</label>
              <input type="text" className="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="å®Œæ•´çš„ç½‘ç«™URL" />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700">ç®¡ç†å‘˜é‚®ç®±</label>
              <input type="email" className="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="ç®¡ç†å‘˜è”ç³»é‚®ç®±" />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700">å¤‡æ¡ˆä¿¡æ¯</label>
              <input type="text" className="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="ä¸­å›½å¤§é™†ICPå¤‡æ¡ˆå·" />
            </div>
          </div>
          <div className="mt-4">
            <button className="bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">ä¿å­˜è®¾ç½®</button>
          </div>
        </div>
      </div>
    );
    
    const PythonIntegration = () => (
      <div>
        <h1 className="text-2xl font-bold mb-6">PythonåŠŸèƒ½é›†æˆ</h1>
        <p className="text-gray-600">é›†æˆPythonå®ç°çš„é«˜çº§åŠŸèƒ½</p>
        
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
          <div className="bg-white p-6 rounded-lg shadow">
            <h3 className="text-lg font-semibold mb-4">æ–‡æœ¬åˆ†æ</h3>
            <textarea 
              className="w-full border border-gray-300 rounded-md p-2 mb-4" 
              placeholder="è¾“å…¥è¦åˆ†æçš„æ–‡æœ¬..."
              rows="4"
            ></textarea>
            <button className="bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">åˆ†ææ–‡æœ¬</button>
          </div>
          
          <div className="bg-white p-6 rounded-lg shadow">
            <h3 className="text-lg font-semibold mb-4">å†…å®¹ä¼˜åŒ–å»ºè®®</h3>
            <input 
              type="text" 
              className="w-full border border-gray-300 rounded-md p-2 mb-2" 
              placeholder="æ–‡ç« æ ‡é¢˜" 
            />
            <textarea 
              className="w-full border border-gray-300 rounded-md p-2 mb-2" 
              placeholder="æ–‡ç« å†…å®¹..."
              rows="3"
            ></textarea>
            <input 
              type="text" 
              className="w-full border border-gray-300 rounded-md p-2 mb-4" 
              placeholder="å…³é”®è¯ï¼ˆé€—å·åˆ†éš”ï¼‰" 
            />
            <button className="bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600">ç”Ÿæˆä¼˜åŒ–å»ºè®®</button>
          </div>
        </div>
      </div>
    );
    
    // ä¸»åº”ç”¨ç»„ä»¶
    const App = () => {
      const [activePage, setActivePage] = useState('dashboard');
      
      const renderPage = () => {
        switch(activePage) {
          case 'dashboard': return <Dashboard />;
          case 'content': return <ContentManagement />;
          case 'analytics': return <Analytics />;
          case 'seo': return <SeoSettings />;
          case 'ads': return <AdManagement />;
          case 'settings': return <SiteSettings />;
          case 'python': return <PythonIntegration />;
          default: return <Dashboard />;
        }
      };
      
      return (
        <div className="flex">
          <Sidebar activePage={activePage} setActivePage={setActivePage} />
          <div className="admin-main">
            {renderPage()}
          </div>
        </div>
      );
    };
    
    // æ¸²æŸ“åº”ç”¨
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>