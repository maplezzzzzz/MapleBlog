---
import { getCollection, type CollectionEntry, render } from "astro:content";
import EntryLayout from "@components/blog/EntryLayout.astro";

interface Props {
  entry: string;
}

const { entry: slugOrId } = Astro.props;

// 根据slug或ID获取文章
let blogEntry: CollectionEntry<"blog"> | undefined = undefined;

try {
  // 首先尝试通过slug获取
  const blogCollection = await getCollection('blog');
  blogEntry = blogCollection.find(post => post.slug === slugOrId || post.id.replace(/\.md$/, '') === slugOrId);
} catch (e) {
  console.error("获取博客文章时出错:", e);
}

if (!blogEntry) {
  // 如果条目未定义，显示错误信息
  return <div>文章未找到</div>;
}

const { Content } = await render(blogEntry);
---

<EntryLayout entry={blogEntry}>
  <Content />
</EntryLayout>
